<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>String Hash Function</title>
<script>
/* ---------- Utility ---------- */
function hashCode(str) {
    let hash = 0;
    if (str.length === 0) return hash;
    for (let i = 0; i < str.length; i++) {
        const char = str.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash |= 0;                    // 32‑bit
    }
    return Math.abs(hash);
}

/* ---------- Formatter ---------- */
function formatEntry(obj, asYaml) {
    if (asYaml) {
        return `message: "${obj.message}"
anchor: "${obj.anchor}"
severity: "${obj.severity}"
context: "${obj.context}"
description: "${obj.description}"
name: "${obj.name}"`;
    } else { // JSON
        return JSON.stringify(obj, null, 2);
    }
}

/* ---------- Core ---------- */
function performHash() {
    const asYaml = document.getElementById("formatSelect").value === "yaml";

    const messages    = document.getElementById("messages").value.split('\n');
    const descriptions= document.getElementById("description").value.split('\n');
    const contexts    = document.getElementById("context").value.split('\n');
    const severities  = document.getElementById("severities").value.split('\n');

    const entries = messages.map((msg, i) => {
        if (msg.trim() === "") return null;
        const context = contexts[i] || contexts[0] || "";
        const obj = {
            message:     msg,
            anchor:      `${context}__${hashCode(msg+"\n")}`,
            severity:    severities[i] || severities[0] || "",
            context:     context,
            description: descriptions[i] || "",
            name:        String(hashCode(msg+"\n"))
        };
        return formatEntry(obj, asYaml);
    }).filter(Boolean);

    let result = asYaml ? entries.join('\n\n') : '[\n' + entries.join(',\n') + '\n]';
    document.getElementById("hashResult").textContent = result;
}

/* ---------- Live binding ---------- */
window.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('textarea, #formatSelect')
            .forEach(el => el.addEventListener('input', performHash));
    performHash(); // initial render
});
</script>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f9f9f9;
    color:#333;
    margin:10; padding:10;
    display:flex; flex-direction:column;
    align-items:center; justify-content:center;
    min-height:100vh;
}
.container{
    width:90%; max-width:1000px;
    background:#fff; padding:40px;
    border-radius:8px;
    box-shadow:0 2px 4px rgba(0,0,0,.1);
    text-align:center;
}
h2{margin-bottom:5px; color:#2c3e50;}
h3{margin-top:0; font-weight:normal; font-size:1.1em; color:#7f8c8d;}
textarea, select{
    width:80%; max-width:600px;
    margin:10px 0; padding:10px;
    border:1px solid #ccc; border-radius:4px;
    font-size:1em;
}
#hashResult{
    font-family:monospace; white-space:pre;
    background:#ecf0f1; padding:10px;
    border:1px solid #ccc; margin-top:20px;
    width:80%; max-width:600px;
    text-align:left;
    font-size:1.1em;          /* enlarged */
}
@media (max-width:600px){
    textarea, select{width:95%;}
    #hashResult{width:95%;}
}
.format-wrapper{
    display:flex; align-items:center;
    justify-content:center; gap:8px;
    margin-bottom:10px;
}
</style>
</head>
<body>
<div class="container">
    <h2>Server Log Reference Documentation Formatting Utility</h2>
    <div class="format-wrapper">
        <label for="formatSelect">Output:</label>
        <select id="formatSelect">
            <option value="yaml" selected>YAML</option>
            <option value="json">JSON</option>
        </select>
    </div>
    <p>Paste the log messages into the first box and, optionally, descriptions, contexts, and log‑message severities into the following boxes.<br> The output updates in real time.<br><br>If you supply only one context or severity level, the tool applies it to all log messages.</p>

    <textarea id="messages"     placeholder="Enter messages separated by new lines" rows="8"></textarea>
    <textarea id="description"  placeholder="Enter descriptions separated by new lines" rows="8"></textarea>
    <textarea id="context"      placeholder="Enter log message contexts separated by new lines" rows="8"></textarea>
    <textarea id="severities"   placeholder="Enter log message severity levels separated by new lines" rows="8"></textarea>

    <pre id="hashResult"></pre>
</div>
</body>
</html>
